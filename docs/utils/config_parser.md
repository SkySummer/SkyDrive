# ⚙️ ConfigParser 模块

`ConfigParser` 模块是 HTTP 服务器的配置管理工具，负责解析键值对格式的配置文件，支持多种数据类型转换，提供默认值回退机制，并集成日志级别解析功能，简化服务器配置的动态加载与管理。

## ✨ 模块职责

- **配置文件解析**：读取配置文件，提取有效键值对。
- **类型安全转换**：通过模板方法支持 `int`、`string`、`bool` 等类型的配置值获取。
- **日志级别解析**：将字符串（如 `"DEBUG"`）转换为 `LogLevel` 枚举类型。
- **容错处理**：配置文件缺失或格式错误时，自动回退到默认值并输出警告。

## 📌 核心特性

- **多数据类型支持**：通过模板特化实现 `int`、`double`、`string`、`bool` 等类型的自动转换。
- **布尔值灵活解析**：兼容 `true`/`1`/`yes`/`on` 和 `false`/`0`/`no`/`off` 格式。
- **日志级别映射**：将配置中的字符串（如 `"WARNING"`）映射为 `LogLevel` 枚举。
- **轻量级设计**：无外部依赖，基于标准库实现文件操作与字符串处理。

## 📁 成员组成

| 类型/名称 | 描述 |
| ---- | ---- |
| `std::unordered_map<std::string, std::string> config_map_` | 存储解析后的键值对（如 `port=8080` -> `"port" : "8080"`）。 |
| `std::filesystem::path config_file_` | 配置文件的路径，用于初始化时加载。 |
| `trim`（静态方法） | 去除字符串两端的空白字符，用于清理键值。 |

## ⚙️ 方法概览

| 方法名称 | 功能描述 |
| ---- | ---- |
| **构造函数** | 从指定路径加载配置文件，解析有效键值对并存入 `config_map_`。 |
| `get<T>` | 模板方法，根据键名返回指定类型的配置值，支持默认值回退。 |
| `getLogLevel` | 专用于解析日志级别配置项，返回 `LogLevel` 枚举类型。 |

## 🔄 工作流程

1. 文件加载与解析
   - **文件打开**：尝试读取配置文件，失败时输出警告并使用空配置。
   - **逐行处理**：跳过空行和以 `#` 开头的注释行。
   - **键值分割**：按 `=` 分割每行，去除两端空白后存储（如 `log_level = DEBUG` -> `log_level: "DEBUG"`）。
2. 数据类型特化解析
   - **通用类型**（`int`/`float`/`string`）：通过 `std::istringstream` 直接转换。
   - **布尔值特化**：
     - 支持 `true`/`1`/`yes`/`on` -> **`true`**
     - 支持 `false`/`0`/`no`/`off` -> **`false`**
   - **日志级别特化**：
     - `"DEBUG"` -> `LogLevel::DEBUG`
     - `"INFO"` -> `LogLevel::INFO`
     - `"WARNING"` -> `LogLevel::WARNING`
     - `"ERROR"` -> `LogLevel::ERROR`
3. 容错与默认值
   - **键不存在**：返回用户指定的默认值（如 `get("timeout", 30)` -> `30`）。
   - **类型错误**：转换失败时静默回退（如 `port=abc` -> 使用默认值）。

## 🔑 关键设计

- **模板方法泛化**：通过 `std::istringstream` 实现通用类型转换，减少重复代码。
- **布尔值兼容性**：支持多种常见布尔表示，提升配置灵活性。
- **日志级别专用接口**：隐藏枚举转换细节，简化日志模块集成。
- **隐式容错**：文件打开失败或键缺失时静默处理，保障服务稳定性。

## ⚠️ 注意事项

- **文件格式要求**：键值对必须使用 `=` 分隔，且每行仅支持一个键值对。
- **类型安全限制**：非法的类型转换（如将 `"abc"` 转为 `int`）会返回默认值。
- **大小写敏感**：键名和日志级别字符串区分大小写（如 `"debug"` 无效，需 `"DEBUG"`）。
